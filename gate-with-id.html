<!DOCTYPE html>

<html lang="ja"> <head> <meta charset="UTF-8"> <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no"> <title>Gate - Multi-X Utility</title> <script src="https://unpkg.com/jsqr/dist/jsQR.js"></script> <style> :root { --accent: #d4af37; --bg: #0f172a; --card: #1e293b; --text: #f8fafc; } body { background-color: var(--bg); color: var(--text); font-family: 'BIZ UDPGothic', sans-serif; margin: 0; display: flex; justify-content: center; align-items: center; height: 100vh; overflow: hidden; } #gate-container { width: 90%; max-width: 400px; background: var(--card); border: 3px solid #475569; border-radius: 24px; padding: 30px; text-align: center; } .lock-icon { font-size: 3rem; margin-bottom: 10px; } h3 { color: var(--accent); margin: 0 0 10px 0; } #scanner-area { position: relative; width: 100%; aspect-ratio: 1; background: #000; border-radius: 15px; overflow: hidden; display: none; margin-bottom: 20px; border: 2px solid var(--accent); } video { width: 100%; height: 100%; object-fit: cover; } .btn { background: var(--accent); color: #000; padding: 15px; border-radius: 12px; border: none; font-weight: bold; cursor: pointer; width: 100%; font-size: 1rem; } #status-msg { margin-top: 15px; font-size: 0.8rem; min-height: 1.2em; color: #94a3b8; } </style> </head> <body>

<div id="gate-container"> <div class="lock-icon" id="icon">ğŸ”’</div> <h3>å…ˆè¡Œä½“é¨“ã‚²ãƒ¼ãƒˆ</h3> <div id="scanner-area"> <video id="v" playsinline></video> </div> <button id="start-btn" class="btn" onclick="initScan()">ã‚¹ã‚­ãƒ£ãƒŠãƒ¼èµ·å‹•</button> <div id="status-msg" id="msg">QRã‚’ã‹ã–ã—ã¦ãã ã•ã„</div> </div>

<canvas id="c" style="display:none;"></canvas>

<script> const video = document.getElementById('v'); const msg = document.getElementById('status-msg'); const icon = document.getElementById('icon'); let isFound = false;

function initScan() {
    msg.innerText = &quot;ã‚«ãƒ¡ãƒ©ã‚’æº–å‚™ä¸­...&quot;;
    navigator.mediaDevices.getUserMedia({ video: { facingMode: &quot;environment&quot; } })
        .then(stream =&gt; {
            document.getElementById(&#39;start-btn&#39;).style.display = &quot;none&quot;;
            document.getElementById(&#39;scanner-area&#39;).style.display = &quot;block&quot;;
            video.srcObject = stream;
            video.setAttribute(&quot;playsinline&quot;, true);
            video.play();
            msg.innerText = &quot;QRã‚³ãƒ¼ãƒ‰ã‚’æ å†…ã«å…¥ã‚Œã¦ãã ã•ã„&quot;;
            requestAnimationFrame(tick);
        })
        .catch(err =&gt; {
            msg.innerText = &quot;ã‚¨ãƒ©ãƒ¼: ã‚«ãƒ¡ãƒ©ã‚’èµ·å‹•ã§ãã¾ã›ã‚“ã§ã—ãŸã€‚&quot;;
            msg.style.color = &quot;#ff4757&quot;;
        });
}

function tick() {
    if (isFound) return;
    if (video.readyState === video.HAVE_ENOUGH_DATA) {
        const canvas = document.getElementById(&#39;c&#39;);
        const ctx = canvas.getContext(&#39;2d&#39;);
        canvas.height = video.videoHeight;
        canvas.width = video.videoWidth;
        ctx.drawImage(video, 0, 0, canvas.width, canvas.height);
        const imgData = ctx.getImageData(0, 0, canvas.width, canvas.height);
        const code = jsQR(imgData.data, imgData.width, imgData.height);

        if (code) {
            const data = code.data.trim();
            console.log(&quot;Read QR:&quot;, data); // PCã§è¦‹ã¦ã„ã‚‹å ´åˆã®ã¿ç¢ºèªå¯èƒ½

            if (data.includes(&quot;MULTI-X-2026-PRE&quot;)) {
                isFound = true;
                const parts = data.split(&quot;:&quot;);
                const name = parts[1] || &quot;å…¬å¼é‹å–¶&quot;;
                handleSuccess(name);
                return;
            } else {
                // é•ã†QRã‚’èª­ã¿å–ã£ãŸå ´åˆ
                msg.innerText = &quot;ç„¡åŠ¹ãªQRã§ã™: &quot; + data.substring(0, 10) + &quot;...&quot;;
                msg.style.color = &quot;#ff4757&quot;;
            }
        }
    }
    requestAnimationFrame(tick);
}

function handleSuccess(name) {
    msg.innerText = &quot;èªè¨¼æˆåŠŸï¼ç´¹ä»‹è€…: &quot; + name;
    msg.style.color = &quot;#4ade80&quot;;
    icon.innerText = &quot;ğŸ”“&quot;;
    if (navigator.vibrate) navigator.vibrate(200);

    setTimeout(() =&gt; {
        // ã“ã“ã§ã‚²ãƒ¼ãƒ æœ¬ä½“ã¸ç§»å‹•ã€‚ãƒ•ã‚¡ã‚¤ãƒ«åãŒæ­£ã—ã„ã‹ç¢ºèªã—ã¦ãã ã•ã„ï¼
        window.location.href = &quot;pre-speed-secure.html?ref=&quot; + encodeURIComponent(name);
    }, 1500);
}
</script>

</body> </html>
