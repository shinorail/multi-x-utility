<!DOCTYPE html>

<html lang="ja"> <head> <meta charset="UTF-8"> <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no"> <title>Gate - Multi-X Utility</title> <script src="https://unpkg.com/jsqr/dist/jsQR.js"></script> <style> :root { --accent: #d4af37; --bg: #0f172a; --card: #1e293b; --text: #f8fafc; } body { background-color: var(--bg); color: var(--text); font-family: sans-serif; margin: 0; display: flex; justify-content: center; align-items: center; height: 100vh; overflow: hidden; } #gate-container { width: 90%; max-width: 400px; background: var(--card); border: 3px solid #475569; border-radius: 24px; padding: 30px; text-align: center; display: none; flex-direction: column; align-items: center; } .lock-icon { font-size: 3rem; margin-bottom: 10px; } h3 { color: var(--accent); margin: 0 0 10px 0; } #scanner-area { position: relative; width: 100%; aspect-ratio: 1; background: #000; border-radius: 15px; overflow: hidden; display: none; margin-bottom: 20px; border: 2px solid var(--accent); } video { width: 100%; height: 100%; object-fit: cover; } .btn { background: var(--accent); color: #000; padding: 15px; border-radius: 12px; border: none; font-weight: bold; cursor: pointer; width: 100%; font-size: 1rem; } #status-msg { margin-top: 15px; font-size: 0.8rem; min-height: 1.2em; color: #94a3b8; } #loading-overlay { display: none; position: fixed; inset: 0; background: rgba(0,0,0,0.8); color: white; justify-content: center; align-items: center; flex-direction: column; font-size: 1.2rem; z-index: 9999; } </style> </head> <body>

<div id="gate-container"> <div class="lock-icon" id="icon">ğŸ”’</div> <h3>å…ˆè¡Œä½“é¨“ã‚²ãƒ¼ãƒˆ</h3> <div id="scanner-area"> <video id="v" playsinline></video> </div> <button id="start-btn" class="btn" onclick="initScan()">ã‚¹ã‚­ãƒ£ãƒŠãƒ¼èµ·å‹•</button> <div id="status-msg">QRã‚’ã‹ã–ã—ã¦ãã ã•ã„</div> </div>

<div id="loading-overlay"> <p>ã‚¢ã‚¯ã‚»ã‚¹èªè¨¼ä¸­...</p> <p id="overlay-msg" style="color:#d4af37; font-weight:bold;"></p> </div>

<canvas id="c" style="display:none;"></canvas>

<script> const video = document.getElementById('v'); const msg = document.getElementById('status-msg'); const icon = document.getElementById('icon'); const loadingOverlay = document.getElementById('loading-overlay'); const overlayMsg = document.getElementById('overlay-msg'); let isFound = false;

const BASE_SECRET_KEY = &quot;MULTI-X-2026-PRE&quot;;

window.onload = function() {
    const urlParams = new URLSearchParams(window.location.search);
    const key = urlParams.get(&#39;key&#39;);
    if (key &amp;&amp; key.startsWith(BASE_SECRET_KEY)) {
        showLoading(&quot;URLã‚­ãƒ¼ã‚’æ¤œå‡ºã—ã¾ã—ãŸ&quot;);
        const name = key.split(&quot;:&quot;)[1] || &quot;å…¬å¼é‹å–¶&quot;;
        handleSuccess(name);
        return;
    }
    document.getElementById(&#39;gate-container&#39;).style.display = &#39;flex&#39;;
};

function showLoading(text) {
    loadingOverlay.style.display = &#39;flex&#39;;
    overlayMsg.innerText = text;
}

function initScan() {
    msg.innerText = &quot;ã‚«ãƒ¡ãƒ©ã‚’æº–å‚™ä¸­...&quot;;
    navigator.mediaDevices.getUserMedia({ video: { facingMode: &quot;environment&quot; } })
        .then(stream =&gt; {
            document.getElementById(&#39;start-btn&#39;).style.display = &quot;none&quot;;
            document.getElementById(&#39;scanner-area&#39;).style.display = &quot;block&quot;;
            video.srcObject = stream;
            video.play();
            msg.innerText = &quot;QRã‚³ãƒ¼ãƒ‰ã‚’æ å†…ã«å…¥ã‚Œã¦ãã ã•ã„&quot;;
            requestAnimationFrame(tick);
        })
        .catch(err =&gt; {
            msg.innerText = &quot;ã‚¨ãƒ©ãƒ¼: ã‚«ãƒ¡ãƒ©ã‚’èµ·å‹•ã§ãã¾ã›ã‚“ã§ã—ãŸã€‚&quot;;
            msg.style.color = &quot;#ff4757&quot;;
        });
}

function tick() {
    if (isFound) return;
    if (video.readyState === video.HAVE_ENOUGH_DATA) {
        const canvas = document.getElementById(&#39;c&#39;);
        const ctx = canvas.getContext(&#39;2d&#39;);
        canvas.height = video.videoHeight;
        canvas.width = video.videoWidth;
        ctx.drawImage(video, 0, 0, canvas.width, canvas.height);
        const imgData = ctx.getImageData(0, 0, canvas.width, canvas.height);
        const code = jsQR(imgData.data, imgData.width, imgData.height);

        if (code) {
            const data = code.data.trim();
            if (data.includes(BASE_SECRET_KEY)) {
                isFound = true;
                const name = data.split(&quot;:&quot;).pop() || &quot;å…¬å¼&quot;;
                showLoading(&quot;QRèªè¨¼ã«æˆåŠŸ: &quot; + name);
                handleSuccess(name);
                return;
            } else {
                msg.innerText = &quot;ç„¡åŠ¹ãªQRã§ã™&quot;;
                msg.style.color = &quot;#ff4757&quot;;
            }
        }
    }
    requestAnimationFrame(tick);
}

function handleSuccess(name) {
    icon.innerText = &quot;ğŸ”“&quot;;
    if (navigator.vibrate) navigator.vibrate(200);
    setTimeout(() =&gt; {
        window.location.href = &quot;pre-speed-secure.html?ref=&quot; + encodeURIComponent(name);
    }, 1500);
}
</script>

</body> </html>
