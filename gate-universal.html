<!DOCTYPE html>

<html lang="ja"> <head> <meta charset="UTF-8"> <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no"> <title>Gate - Multi-X Utility</title> <script src="https://cdn.jsdelivr.net/npm/jsqr@1.4.0/dist/jsQR.min.js"></script> <style> :root { --accent: #d4af37; --bg: #0f172a; --card: #1e293b; --text: #f8fafc; } body { background-color: var(--bg); color: var(--text); font-family: sans-serif; margin: 0; display: flex; justify-content: center; align-items: center; height: 100vh; overflow: hidden; } #gate-container { width: 90%; max-width: 400px; background: var(--card); border: 2px solid #475569; border-radius: 20px; padding: 30px; text-align: center; box-sizing: border-box; } #v-area { width: 100%; aspect-ratio: 1; background: #000; border-radius: 12px; overflow: hidden; display: none; margin-bottom: 20px; border: 2px solid var(--accent); position: relative; } video { width: 100%; height: 100%; object-fit: cover; } .btn { background: var(--accent); color: #000; padding: 15px; border-radius: 10px; border: none; font-weight: bold; width: 100%; font-size: 1rem; cursor: pointer; transition: 0.2s; } .btn:active { opacity: 0.8; transform: scale(0.98); } #status { margin-top: 15px; font-size: 0.85rem; color: #94a3b8; line-height: 1.5; } #overlay { display: none; position: fixed; inset: 0; background: var(--bg); z-index: 100; flex-direction: column; justify-content: center; align-items: center; } .m-msg { color: #ff4757; font-weight: bold; border: 1px solid #ff4757; padding: 10px; border-radius: 8px; margin-top: 20px; } </style> </head> <body>

<div id="gate-container"> <div id="m-icon" style="font-size:3rem; margin-bottom:10px;">ğŸ”’</div> <h3 id="m-title" style="color:var(--accent); margin:0 0 15px 0; letter-spacing: 1px;">å…ˆè¡Œä½“é¨“ã‚²ãƒ¼ãƒˆ</h3>

<div id="active-content">
    <div id="v-area"><video id="video" playsinline></video></div>
    <button id="btn" class="btn" onclick="start()">ã‚¹ã‚­ãƒ£ãƒŠãƒ¼ã‚’èµ·å‹•</button>
    <div id="status">æ‹›å¾…QRã‚³ãƒ¼ãƒ‰ã‚’ã‹ã–ã—ã¦ãã ã•ã„</div>
</div>

<div id="maintenance-content" style="display:none;">
    <div class="m-msg">ç¾åœ¨ãƒ¡ãƒ³ãƒ†ãƒŠãƒ³ã‚¹ä¸­ã§ã™</div>
    <p style="font-size:0.85rem; color:#94a3b8;">ã‚ªãƒ•ãƒ©ã‚¤ãƒ³æ©Ÿèƒ½è¿½åŠ ãŠã‚ˆã³<br>ã‚¢ãƒƒãƒ—ãƒ‡ãƒ¼ãƒˆä½œæ¥­ã‚’è¡Œã£ã¦ã„ã¾ã™ã€‚</p>
    <button class="btn" onclick="location.href='menu.html'">ãƒ¡ãƒ‹ãƒ¥ãƒ¼ã«æˆ»ã‚‹</button>
</div>
</div>

<div id="overlay"> <div style="font-size:4rem;">ğŸ”“</div> <h2 style="color:var(--accent);" id="user-name">èªè¨¼æˆåŠŸ</h2> <p>ã¾ã‚‚ãªãè»¢é€ã—ã¾ã™...</p> </div>

<canvas id="canvas" style="display:none;"></canvas>

<script> // â˜… ãƒ¡ãƒ³ãƒ†ãƒŠãƒ³ã‚¹è¨­å®šï¼ˆtrueã§åˆ¶é™ã€falseã§å…¬é–‹ï¼‰ const isMaintenance = true;

const video = document.getElementById(&#39;video&#39;);
const status = document.getElementById(&#39;status&#39;);
const overlay = document.getElementById(&#39;overlay&#39;);
const canvas = document.getElementById(&#39;canvas&#39;);
const ctx = canvas.getContext(&#39;2d&#39;, { willReadFrequently: true });
const SECRET = &quot;MULTI-X-2026-PRE&quot;;

// 1. åˆæœŸåŒ–å‡¦ç†
window.addEventListener(&#39;load&#39;, () =&gt; {
    // ã‚ªãƒ•ãƒ©ã‚¤ãƒ³ç”¨Service Workerã®ç™»éŒ²
    if (&#39;serviceWorker&#39; in navigator) {
        navigator.serviceWorker.register(&#39;./sw.js&#39;)
            .then(() =&gt; console.log(&quot;Offline support ready.&quot;))
            .catch(err =&gt; console.log(&quot;SW failed:&quot;, err));
    }

    // ãƒ¡ãƒ³ãƒ†ãƒŠãƒ³ã‚¹åˆ¤å®š
    if (isMaintenance) {
        document.getElementById(&#39;active-content&#39;).style.display = &#39;none&#39;;
        document.getElementById(&#39;maintenance-content&#39;).style.display = &#39;block&#39;;
        document.getElementById(&#39;m-icon&#39;).innerText = &quot;ğŸ› ï¸&quot;;
        document.getElementById(&#39;m-title&#39;).innerText = &quot;Maintenance&quot;;
        return;
    }

    // URLãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ãƒã‚§ãƒƒã‚¯
    const p = new URLSearchParams(window.location.search);
    const k = p.get(&#39;key&#39;);
    if (k &amp;&amp; k.includes(SECRET)) {
        const name = k.split(&quot;:&quot;)[1] || &quot;æ‹›å¾…ãƒ¦ãƒ¼ã‚¶ãƒ¼&quot;;
        go(name);
    }
});

// 2. ã‚«ãƒ¡ãƒ©èµ·å‹•
async function start() {
    status.innerText = &quot;ã‚«ãƒ¡ãƒ©ã‚’ãƒªã‚¯ã‚¨ã‚¹ãƒˆä¸­...&quot;;
    try {
        const stream = await navigator.mediaDevices.getUserMedia({ video: { facingMode: &quot;environment&quot; } });
        document.getElementById(&#39;btn&#39;).style.display = &#39;none&#39;;
        document.getElementById(&#39;v-area&#39;).style.display = &#39;block&#39;;
        video.srcObject = stream;
        video.onloadedmetadata = () =&gt; {
            video.play();
            status.innerText = &quot;QRã‚³ãƒ¼ãƒ‰ã‚’æ å†…ã«æ˜ ã—ã¦ãã ã•ã„&quot;;
            requestAnimationFrame(tick);
        };
    } catch (err) {
        status.innerHTML = &quot;ã‚¨ãƒ©ãƒ¼: ã‚«ãƒ¡ãƒ©ã‚’èµ·å‹•ã§ãã¾ã›ã‚“ã§ã—ãŸã€‚&quot;;
        status.style.color = &quot;#ff4757&quot;;
    }
}

// 3. QRã‚¹ã‚­ãƒ£ãƒ³
function tick() {
    if (video.readyState === video.HAVE_ENOUGH_DATA) {
        canvas.height = video.videoHeight;
        canvas.width = video.videoWidth;
        ctx.drawImage(video, 0, 0, canvas.width, canvas.height);
        const imgData = ctx.getImageData(0, 0, canvas.width, canvas.height);
        const code = jsQR(imgData.data, imgData.width, imgData.height);

        if (code &amp;&amp; code.data.includes(SECRET)) {
            go(code.data.split(&quot;:&quot;).pop() || &quot;å…¬å¼&quot;);
            return;
        }
    }
    requestAnimationFrame(tick);
}

// 4. æˆåŠŸè»¢é€
function go(name) {
    overlay.style.display = &#39;flex&#39;;
    document.getElementById(&#39;user-name&#39;).innerText = name + &quot; æ§˜&quot;;
    if (video.srcObject) {
        video.srcObject.getTracks().forEach(track =&gt; track.stop());
    }
    setTimeout(() =&gt; {
        window.location.href = &quot;pre-speed-secure.html?ref=&quot; + encodeURIComponent(name);
    }, 1500);
}
</script>

</body> </html>
